function openDatabaseAndReplayRequests(){var a=indexedDB.open("offline-analytics",IDB_VERSION);a.onerror=function(a){},a.onupgradeneeded=function(){this.result.createObjectStore(STORE_NAME,{keyPath:"url"})},a.onsuccess=function(){idbDatabase=this.result,replayAnalyticsRequests()}}function getObjectStore(a,b){return idbDatabase.transaction(a,b).objectStore(a)}function replayAnalyticsRequests(){var a=[];getObjectStore(STORE_NAME).openCursor().onsuccess=function(b){var c=b.target.result;c?(a.push(c.value),c.continue()):a.forEach(function(a){var b=Date.now()-a.timestamp;if(b>STOP_RETRYING_AFTER)getObjectStore(STORE_NAME,"readwrite").delete(a.url);else{var c=a.url+"&qt="+b;fetch(c).then(function(b){b.status<400&&getObjectStore(STORE_NAME,"readwrite").delete(a.url)}).catch(function(a){})}})}}function checkForAnalyticsRequest(a){var b=new URL(a);"www.google-analytics.com"!==b.hostname&&"ssl.google-analytics.com"!==b.hostname||"/collect"!==b.pathname||saveAnalyticsRequest(a)}function saveAnalyticsRequest(a){getObjectStore(STORE_NAME,"readwrite").add({url:a,timestamp:Date.now()})}var CACHE_VERSION=1,CURRENT_CACHES={"offline-analytics":"offline-analytics-v"+CACHE_VERSION},idbDatabase,IDB_VERSION=1,STOP_RETRYING_AFTER=864e5,STORE_NAME="urls";openDatabaseAndReplayRequests(),self.addEventListener("activate",function(a){var b=Object.keys(CURRENT_CACHES).map(function(a){return CURRENT_CACHES[a]});a.waitUntil(caches.keys().then(function(a){return Promise.all(a.map(function(a){return-1===b.indexOf(a)?caches.delete(a):void 0}))}))});var urlsToCache=["/","/lib/jquery/dist/jquery.min.js","/js/app.min.js","/js/lib.min.js","/css/app.min.css","https://fonts.googleapis.com/css?family=Quicksand:300,400,700","https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js","/favicon-16x16.png","/favicon-96x96.png","/favicon-32x32.png","/apple-icon-57x57.png","/apple-icon-60x60.png","/apple-icon-72x72.png","/apple-icon-76x76.png","/apple-icon-114x114.png","/apple-icon-120x120.png","/apple-icon-144x144.png","/apple-icon-152x152.png","/apple-icon-180x180.png","/android-icon-192x192.png","/favicon.ico","/manifest.json","/ms-icon-144x144.png"];self.addEventListener("install",function(a){a.waitUntil(caches.open(CURRENT_CACHES["offline-analytics"]).then(function(a){return a.addAll(urlsToCache)}))}),self.addEventListener("fetch",function(a){a.respondWith(caches.open(CURRENT_CACHES["offline-analytics"]).then(function(b){return b.match(a.request).then(function(c){return c?c:fetch(a.request.clone()).then(function(c){return c.status<400?b.put(a.request,c.clone()):c.status>=500&&checkForAnalyticsRequest(a.request.url),c}).catch(function(b){throw checkForAnalyticsRequest(a.request.url),b})}).catch(function(a){throw a})}))});